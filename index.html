<!-- ===========================
File: sender.html
Purpose: Cast sender web app to send 5 tickers to your Chromecast (Vizio TV with Chromecast built-in)
Host this file on any static site host. Replace CAST_APP_ID below with your own Custom Receiver App ID from the Google Cast SDK Console.
=========================== -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cast: Stock Dashboard Sender</title>
  <script type="text/javascript" src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
  <style>
    :root { --bg:#0f172a; --card:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#22d3ee; }
    html,body { height:100%; margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background:linear-gradient(180deg,#0b1022,#0f172a); color:var(--text); }
    .wrap { max-width: 840px; margin: 0 auto; padding: 32px 16px; }
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.06); border-radius: 18px; padding: 22px; box-shadow: 0 10px 30px rgba(0,0,0,0.35); }
    h1 { font-size: 28px; margin: 0 0 12px; letter-spacing: 0.3px; }
    p.sub { color: var(--muted); margin: 0 0 20px; }
    .grid { display:grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
    input[type=text] { width:100%; padding:12px 10px; border-radius:12px; border:1px solid rgba(255,255,255,0.08); background:#0b1220; color:var(--text); font-weight:600; text-transform:uppercase; letter-spacing:1px; text-align:center; }
    .row { display:flex; gap:10px; flex-wrap:wrap; margin-top: 16px; align-items:center; }
    button { cursor:pointer; border:0; padding:12px 16px; border-radius:14px; font-weight:700; }
    .primary { background: linear-gradient(90deg, #06b6d4, #22d3ee); color:#001016; }
    .ghost { background:transparent; border:1px solid rgba(255,255,255,0.16); color:var(--text); }
    small { color: var(--muted); }
    .bad { color:#fda4af; }
    .ok { color:#86efac; }
    footer { margin-top: 18px; color: var(--muted); font-size: 12px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Chromecast Stock Dashboard — Sender</h1>
      <p class="sub">Enter 5 tickers. Click <strong>Cast to TV</strong> to launch your receiver and show the dashboard on your Vizio TV.</p>
      <div class="grid">
        <input id="t1" type="text" value="AAPL" maxlength="12" />
        <input id="t2" type="text" value="MSFT" maxlength="12" />
        <input id="t3" type="text" value="NVDA" maxlength="12" />
        <input id="t4" type="text" value="GOOGL" maxlength="12" />
        <input id="t5" type="text" value="AMZN" maxlength="12" />
      </div>
      <div class="row">
        <button id="castBtn" class="primary">🔊 Cast to TV</button>
        <button id="updateBtn" class="ghost">↻ Update Live</button>
        <small id="status">Status: <span class="bad">Not connected</span></small>
      </div>
      <footer>
        <div>Cast App ID: <code id="appId">YOUR_CAST_APP_ID</code> (replace in code)</div>
      </footer>
    </div>
  </div>

  <script>
    const CAST_APP_ID = '8D54F371'; // ← replace with your Custom Receiver App ID
    const NAMESPACE = 'urn:x-cast:ticker.dashboard';

    const ctx = cast.framework.CastContext.getInstance();
    ctx.setOptions({
      receiverApplicationId: CAST_APP_ID,
      autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
    });

    const castBtn = document.getElementById('castBtn');
    const updateBtn = document.getElementById('updateBtn');
    const statusEl = document.getElementById('status');

    function getTickers(){
      return [1,2,3,4,5].map(i => document.getElementById('t'+i).value.trim().toUpperCase()).filter(Boolean);
    }

    function setStatus(txt, ok=false){
      statusEl.innerHTML = 'Status: ' + (ok ? `<span class="ok">${txt}</span>` : `<span class="bad">${txt}</span>`);
    }

    async function requestSessionAndSend(){
      try {
        const session = await ctx.requestSession();
        setStatus('Connected to ' + session.getCastDevice().friendlyName, true);
        sendTickers();
      } catch(err){
        console.error(err);
        setStatus('Not connected');
        alert('Cast failed. Make sure your TV is on and the receiver app is registered.');
      }
    }

    function sendTickers(){
      const session = ctx.getCurrentSession();
      if(!session){ setStatus('Not connected'); return; }
      const message = { tickers: getTickers(), ts: Date.now() };
      session.sendMessage(NAMESPACE, message).then(() => {
        setStatus('Updated tickers on TV at ' + new Date().toLocaleTimeString(), true);
      }).catch(err => {
        console.error(err);
        setStatus('Send failed');
      });
    }

    castBtn.addEventListener('click', requestSessionAndSend);
    updateBtn.addEventListener('click', sendTickers);
  </script>
</body>
</html>

